pipeline {

    agent any

    stages {

        stage('Preparations') {
            steps {
                script{ 
                    sh "echo 'pipeline has started'"
                    sh "curl google.com"
                    
                    sh """
                         if [ ! -f helm ]; then
                            /usr/bin/curl -fsSL -o helm.tar.gz  https://get.helm.sh/helm-v3.7.1-linux-amd64.tar.gz
                            tar -xzf helm.tar.gz linux-amd64/helm
                            mv linux-amd64/helm helm
                            chmod +x helm
                        fi
                    """

                    sh ". helm repo add azure-samples https://azure-samples.github.io/helm-charts/"
                    sh ". helm install azure-samples/aks-helloworld" 
                }
            }
        }
    }       
}